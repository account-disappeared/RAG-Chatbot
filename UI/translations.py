available_languages = ["en", "fr", "zh","es","it","de","ja"]

translations = {
    "en": {
        "app_title": "Langchain RAG Chatbot",
        "select_model": "Select Model",
        "chat_placeholder": "Query:",
        "generating": "Generating response...",
        "api_error": "Failed to get a response from the API. Please try again.",
        "upload_document": "Upload Document",
        "choose_file": "Choose a file",
        "upload_button": "Upload",
        "uploading": "Uploading...",
        "upload_success": "File '{filename}' uploaded successfully with ID {file_id}.",
        "uploaded_documents": "Uploaded Documents",
        "refresh_documents": "Refresh Document List",
        "refreshing": "Refreshing...",
        "select_to_delete": "Select a document to delete",
        "delete_button": "Delete Selected Document",
        "deleting": "Deleting...",
        "delete_success": "Document with ID {file_id} deleted successfully.",
        "delete_error": "Failed to delete document with ID {file_id}.",
        "details": "Details",
        "generated_answer": "Generated Answer",
        "model_used": "Model Used",
        "session_id": "Session ID",
        "select_language": "Select Language",
        "auto_detected": "Auto-detected from browser ({browser_lang})",
    },
    "fr": {
        "app_title": "Chatbot RAG Langchain",
        "select_model": "Sélectionner le Modèle",
        "chat_placeholder": "Question :",
        "generating": "Génération de la réponse...",
        "api_error": "Échec de l'obtention d'une réponse de l'API. Veuillez réessayer.",
        "upload_document": "Télécharger un Document",
        "choose_file": "Choisir un fichier",
        "upload_button": "Télécharger",
        "uploading": "Téléchargement en cours...",
        "upload_success": "Fichier '{filename}' téléchargé avec succès avec l'ID {file_id}.",
        "uploaded_documents": "Documents Téléchargés",
        "refresh_documents": "Actualiser la Liste des Documents",
        "refreshing": "Actualisation...",
        "select_to_delete": "Sélectionnez un document à supprimer",
        "delete_button": "Supprimer le Document Sélectionné",
        "deleting": "Suppression...",
        "delete_success": "Document avec l'ID {file_id} supprimé avec succès.",
        "delete_error": "Échec de la suppression du document avec l'ID {file_id}.",
        "details": "Détails",
        "generated_answer": "Réponse Générée",
        "model_used": "Modèle Utilisé",
        "session_id": "ID de Session",
        "select_language": "Choisir la Langue",
        "auto_detected": "Détecté automatiquement du navigateur ({browser_lang})",
    },
    "zh": {
        "app_title": "Langchain RAG 聊天机器人",
        "select_model": "选择模型",
        "chat_placeholder": "查询：",
        "generating": "正在生成回复…",
        "api_error": "无法从 API 获取回复，请重试。",
        "upload_document": "上传文档",
        "choose_file": "选择文件",
        "upload_button": "上传",
        "uploading": "正在上传…",
        "upload_success": "文件 '{filename}' 上传成功，ID 为 {file_id}。",
        "uploaded_documents": "已上传的文档",
        "refresh_documents": "刷新文档列表",
        "refreshing": "正在刷新…",
        "select_to_delete": "选择要删除的文档",
        "delete_button": "删除选中文档",
        "deleting": "正在删除…",
        "delete_success": "ID 为 {file_id} 的文档已成功删除。",
        "delete_error": "删除 ID 为 {file_id} 的文档失败。",
        "details": "详细信息",
        "generated_answer": "生成的回答",
        "model_used": "使用的模型",
        "session_id": "会话 ID",
        "select_language": "选择语言",
        "auto_detected": "自动从浏览器检测 ({browser_lang})",
    },
    "es": {
        "app_title": "Chatbot Langchain RAG",
        "select_model": "Seleccionar modelo",
        "chat_placeholder": "Consulta:",
        "generating": "Generando respuesta…",
        "api_error": "No se pudo obtener respuesta de la API. Por favor, inténtalo de nuevo.",
        "upload_document": "Subir documento",
        "choose_file": "Elegir archivo",
        "upload_button": "Subir",
        "uploading": "Subiendo…",
        "upload_success": "Archivo «{filename}» subido con éxito con ID {file_id}.",
        "uploaded_documents": "Documentos subidos",
        "refresh_documents": "Actualizar lista de documentos",
        "refreshing": "Actualizando…",
        "select_to_delete": "Selecciona un documento para eliminar",
        "delete_button": "Eliminar documento seleccionado",
        "deleting": "Eliminando…",
        "delete_success": "Documento con ID {file_id} eliminado correctamente.",
        "delete_error": "Error al eliminar el documento con ID {file_id}.",
        "details": "Detalles",
        "generated_answer": "Respuesta generada",
        "model_used": "Modelo utilizado",
        "session_id": "ID de sesión",
        "select_language": "Seleccionar idioma",
        "auto_detected": "Detectado automáticamente desde el navegador ({browser_lang})",
    },
    "it": {
        "app_title": "Chatbot Langchain RAG",
        "select_model": "Seleziona modello",
        "chat_placeholder": "Richiesta:",
        "generating": "Generazione della risposta…",
        "api_error": "Impossibile ottenere una risposta dall’API. Per favore riprova.",
        "upload_document": "Carica documento",
        "choose_file": "Scegli file",
        "upload_button": "Carica",
        "uploading": "Caricamento in corso…",
        "upload_success": "File «{filename}» caricato con successo con ID {file_id}.",
        "uploaded_documents": "Documenti caricati",
        "refresh_documents": "Aggiorna elenco documenti",
        "refreshing": "Aggiornamento in corso…",
        "select_to_delete": "Seleziona un documento da eliminare",
        "delete_button": "Elimina documento selezionato",
        "deleting": "Eliminazione in corso…",
        "delete_success": "Documento con ID {file_id} eliminato con successo.",
        "delete_error": "Impossibile eliminare il documento con ID {file_id}.",
        "details": "Dettagli",
        "generated_answer": "Risposta generata",
        "model_used": "Modello utilizzato",
        "session_id": "ID sessione",
        "select_language": "Seleziona lingua",
        "auto_detected": "Rilevato automaticamente dal browser ({browser_lang})",
    },
    "de": {
        "app_title": "Langchain RAG Chatbot",
        "select_model": "Modell auswählen",
        "chat_placeholder": "Anfrage:",
        "generating": "Antwort wird generiert…",
        "api_error": "Keine Antwort von der API erhalten. Bitte versuche es erneut.",
        "upload_document": "Dokument hochladen",
        "choose_file": "Datei auswählen",
        "upload_button": "Hochladen",
        "uploading": "Lädt hoch…",
        "upload_success": "Datei „{filename}“ erfolgreich hochgeladen mit ID {file_id}.",
        "uploaded_documents": "Hochgeladene Dokumente",
        "refresh_documents": "Dokumentenliste aktualisieren",
        "refreshing": "Aktualisiere…",
        "select_to_delete": "Wähle ein Dokument zum Löschen aus",
        "delete_button": "Ausgewähltes Dokument löschen",
        "deleting": "Löscht…",
        "delete_success": "Dokument mit ID {file_id} erfolgreich gelöscht.",
        "delete_error": "Löschen des Dokuments mit ID {file_id} fehlgeschlagen.",
        "details": "Details",
        "generated_answer": "Generierte Antwort",
        "model_used": "Verwendetes Modell",
        "session_id": "Sitzungs-ID",
        "select_language": "Sprache auswählen",
        "auto_detected": "Automatisch erkannt vom Browser ({browser_lang})",
    },
    "ja": {
        "app_title": "Langchain RAG チャットボット",
        "select_model": "モデルを選択",
        "chat_placeholder": "クエリ：",
        "generating": "応答を生成中…",
        "api_error": "API からの応答取得に失敗しました。再試行してください。",
        "upload_document": "ドキュメントをアップロード",
        "choose_file": "ファイルを選択",
        "upload_button": "アップロード",
        "uploading": "アップロード中…",
        "upload_success": "ファイル「{filename}」が正常にアップロードされました。ID：{file_id}",
        "uploaded_documents": "アップロード済みドキュメント",
        "refresh_documents": "ドキュメント一覧を更新",
        "refreshing": "更新中…",
        "select_to_delete": "削除するドキュメントを選択",
        "delete_button": "選択したドキュメントを削除",
        "deleting": "削除中…",
        "delete_success": "ID {file_id} のドキュメントが正常に削除されました。",
        "delete_error": "ID {file_id} のドキュメントの削除に失敗しました。",
        "details": "詳細",
        "generated_answer": "生成された回答",
        "model_used": "使用モデル",
        "session_id": "セッション ID",
        "select_language": "言語を選択",
        "auto_detected": "ブラウザから自動検出 ({browser_lang})",
    }
}


def get_text(key, lang="en", **kwargs):
    """Get the text for the given key in the selected language with formatting."""
    try:
        text = translations[lang][key]
        # Apply any format string parameters
        if kwargs:
            return text.format(**kwargs)
        return text
    except KeyError:
        # Fallback to English if translation not found
        try:
            return translations["en"][key]
        except KeyError:
            return key  # Return the key itself as a last resort
